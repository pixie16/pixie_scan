<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Pixie16 Analysis Software Suite: Quickstart</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="main.html">Pixie16 Analysis Software</a>&nbsp;&raquo&nbsp;<a class="el" href="useman.html">User's Manual</a>
  </div>
</div>
<div class="contents">


<h1><a class="anchor" id="quickstart">Quickstart </a></h1><h2><a class="anchor" id="qs-overview">
Overview</a></h2>
<p>Here you will find information on how to quickly start using this software. We will be working under the assumption that you have no desire to know the inner workings of the code, but simply want to get some graphs to look at. Because of the major overhauls the original guide is no longer relevant for this software. If you have an older version of the code, I refer you to the <a class="el" href="quickstart-v1.html">Original Quickstart</a>.</p>
<p>This guide will assume that you are not going to be using ROOT to perform the analysis. However, we will assume that you will be looking at data that requires high resolution timing algorithms. This is the most common type of user at this point, if you do not require this analysis you can simply not follow those instructions. We will also assume that you have compiled the documentation successfully, otherwise you wouldn't be reading this...</p>
<p>Let's assume that we have a simple TOF style measurement going. We'll have three channels: two for VANDLE and one for our start detector.</p>
<h2><a class="anchor" id="qs-prerequisites">
Prerequisites</a></h2>
<p>The code has a number of prerequisites that need to be met in order for you to begin. Here is a handy check-list:</p>
<ul>
<li><a href="ftp://ftp.phy.ornl.gov/pub/upak/Linux/">HRIBF/ORNL Libraries</a> - These need to be compiled and installed on the analysis computer. Please be aware that the installation of these files is not supported by the development team of this software. If you ask nicely they may help.</li>
<li><a href="https://www.gnu.org/software/gsl/">GNU Scientific Library</a> - This software is usually available as a software package from your favorite Linux distro. It is necessary for the high-resolution timing algorithms, if you do not need them, nor will need them in the future, you can skip this one.</li>
</ul>
<h3><a class="anchor" id="qs-env">
Environment Preparation</a></h3>
<p>If you have successfully installed the prerequisites then you are now ready to prepare your Linux environment. You should add the following information into your ".bashrc", which is usually located in the ${HOME} directory of your username.</p>
<div class="fragment"><pre class="fragment">    export HHIRF_DIR=/absolute/path/to/hhirf
    export ACQ2_LIBDIR=/absolute/path/to/acq2/lib
    export HHIRF_GFORTRAN=1
    export EXTRA_PROCESSORS=/absolute/path/to/extra/processors
</pre></div><p>You should replace "/absolute/path/to" with the proper absolute path to the two directories. The last line in the above code is depends on the FORTRAN compiler that was used to compile the HRIBF libraries. The two you are likely to encounter are 'g77' and 'gfortran'. If you are unsure about the installation, contact your system admin.</p>
<p>When you are finished making the necessary changes to the '.bashrc', remember to source it. </p>
<div class="fragment"><pre class="fragment">    source ~/.bashrc
</pre></div><h2><a class="anchor" id="compile">
Compilation</a></h2>
<p>Moving right along, now we are ready to modify the Makefile to the specific installation. There are a number of flags in the upper part of the Makefile that you can modify to suit your needs. The full list of these flags can be found in <a class="el" href="makeflags.html">Makefile Flags</a>. For now, we just need to make sure that the "PULSEFIT" flag is uncommented.</p>
<h2><a class="anchor" id="qs-prepconfig">
Prepare Configuration File</a></h2>
<p>Now comes the most important part. This one is going to be the biggie, the whole mamma-jamma. The configuration file controls the whole operation now. For a complete overview of the configuration, see the page <a class="el" href="xmlconfig.html">XML Based Configuration File</a>.</p>
<p>__NOTE: This file is read at runtime, you do not have to recompile when you make changes here!!__</p>
<h3><a class="anchor" id="qs-author">
Author Node</a></h3>
<p>First, you should update the author information and description. This is not strictly necessary, but it makes it nicer when you are trying to figure out who made the file, and what they were trying to do.</p>
<h3><a class="anchor" id="qs-global">
Global Parameters Node</a></h3>
<p>We are assuming you want to look at VANDLE related data, so you're going to want to make sure that the Revision version is set to "F" for the Pixie16-250 modules.</p>
<p>You can also change the "energyContraction" and "eventWidth" here. For now, we will assume you're happy with whatever was there when you got the file. Some common values are 1e-6 s for eventWidth and 1.0 for the energyContraction.</p>
<h3><a class="anchor" id="qs-driver">
Setup the Detector Driver Node</a></h3>
<p>__OK, now we're onto the serious stuff, pay attention!__ The node <a class="el" href="d4/d4a/classDetectorDriver.html" title="DetectorDriver controls event processing.">DetectorDriver</a> holds the various Processors and Analyzers that you are going to be using for the analysis. For our simple example we will be wanting the following pieces: </p>
<div class="fragment"><pre class="fragment">    &lt;Processor name=<span class="stringliteral">&quot;BetaScintProcessor&quot;</span>/&gt;
    &lt;Processor name=<span class="stringliteral">&quot;VandleProcessor&quot;</span> types=<span class="stringliteral">&quot;small&quot;</span> res=<span class="stringliteral">&quot;2&quot;</span> offset=<span class="stringliteral">&quot;200&quot;</span>/&gt;

    &lt;Analyzer name=<span class="stringliteral">&quot;WaveformAnalyzer&quot;</span>/&gt;
    &lt;Analyzer name=<span class="stringliteral">&quot;FittingAnalyzer&quot;</span>/&gt;
</pre></div><p>The two processor lines define the classes that will handle the manipulation of the data to measure our ToF. The analyzers, work specifically on the traces, and these two will provide the high resolution timing. There are some of the processors that take arguments into their constructors (Ge, Vandle), information on these arguments can be found in the pages for the respective class.</p>
<p>In some analysis, you do not need to define multiple processors to handle information. For example, the <a class="el" href="de/d92/classVandleProcessor.html" title="Class to process VANDLE related events.">VandleProcessor</a> does not need the Beta or Double Beta processors defined in order to perform time-of-flight calculations. This is because these processors pull the necessary detector summaries themselves and build the required information. In these scenarios, you may simply define the <a class="el" href="de/d92/classVandleProcessor.html" title="Class to process VANDLE related events.">VandleProcessor</a>, unless you require histograms built in the Beta or Double Beta processors.</p>
<h3><a class="anchor" id="qs-map">
Setup the Map Node</a></h3>
<p>The Map node tells the program what type of detector is plugged into a given Module/Channel combination. We have moved to this scheme since we now define both the energy calibration and walk calibration at this point. The tags for a channel are now defined as a comma separated list inside the "tags" key. Below is the sample code for our current example: </p>
<div class="fragment"><pre class="fragment">    &lt;Module number=<span class="stringliteral">&quot;0&quot;</span>&gt;
        &lt;Channel number=<span class="stringliteral">&quot;0&quot;</span> type=<span class="stringliteral">&quot;scint&quot;</span> subtype=<span class="stringliteral">&quot;beta&quot;</span>&gt;
            &lt;WalkCorrection model=<span class="stringliteral">&quot;None&quot;</span>&gt;
            &lt;/WalkCorrection&gt;
        &lt;/Channel&gt;
        &lt;Channel number=<span class="stringliteral">&quot;2&quot;</span> type=<span class="stringliteral">&quot;vandle&quot;</span> subtype=<span class="stringliteral">&quot;small&quot;</span> tags=<span class="stringliteral">&quot;left&quot;</span> numStarts=<span class="stringliteral">&quot;2&quot;</span>&gt;
            &lt;WalkCorrection model=<span class="stringliteral">&quot;None&quot;</span>&gt;
            &lt;/WalkCorrection&gt;
        &lt;/Channel&gt;
        &lt;Channel number=<span class="stringliteral">&quot;3&quot;</span> type=<span class="stringliteral">&quot;vandle&quot;</span> subtype=<span class="stringliteral">&quot;small&quot;</span> tags=<span class="stringliteral">&quot;right&quot;</span>&gt;
            &lt;WalkCorrection model=<span class="stringliteral">&quot;None&quot;</span>&gt;
            &lt;/WalkCorrection&gt;
        &lt;/Channel&gt;
    &lt;/Module&gt;
</pre></div><p>None of our channels will be corrected for walk, or energy calibrated. This example may be updated in the future to add in a clover.</p>
<h3><a class="anchor" id="qs-tcal">
TimeCalibration Node Setup</a></h3>
<p>We are now ready to input the timing calibrations. These calibrations are used to align the gamma prompts for the ToF measurement. In addition, this section defines the physical position of the bar relative to the initial position of the measured particle (gamma, neutron, etc.). This calibration differs from the previous one, as it is done on a bar-by-bar basis and not per channel.</p>
<p>If you do not include a calibration for a channel into this node, the program will provide a default calibration of 0.0 for all offsets. In addition, any of the offsets that are left out of the correction, for example if you did not measure an "xoffset", it will automatically be set to zero. This removes the necessity for the declaration of <b>all</b> of the detectors in the analysis.</p>
<p>Finally, the program now recognizes more than two start detectors. This is done through a list of "tofoffsets". Please refer to the sample code below, as well as, the sample configuration: config/Config.xml.example. The "loc" field in the start nodes denote the location of the starts. In the event that the start is a bar style detector, this will refer to the bar number. For a detailed description of these variables refer to <a class="el" href="timecal.html">Time Calibrations and VANDLE Setup</a>.</p>
<p>Inside the TimeCalibration node we will have the following code: </p>
<div class="fragment"><pre class="fragment">    &lt;Vandle&gt;
        &lt;small&gt;
            &lt;Bar number=<span class="stringliteral">&quot;0&quot;</span> z0=<span class="stringliteral">&quot;50.5&quot;</span> xoffset=<span class="stringliteral">&quot;1.0&quot;</span> zoffset=<span class="stringliteral">&quot;0.00&quot;</span>
                lroffset=<span class="stringliteral">&quot;-5.70784&quot;</span>&gt;
                    &lt;start loc=<span class="stringliteral">&quot;0&quot;</span> offset=<span class="stringliteral">&quot;2.90192&quot;</span>/&gt;
                    &lt;start loc=<span class="stringliteral">&quot;1&quot;</span> offset=<span class="stringliteral">&quot;-6.52371&quot;</span>/&gt;
                    &lt;start loc=<span class="stringliteral">&quot;2&quot;</span> offset=<span class="stringliteral">&quot;1.23556&quot;</span>/&gt;
                    &lt;start loc=<span class="stringliteral">&quot;3&quot;</span> offset=<span class="stringliteral">&quot;-5.56573&quot;</span>/&gt;
            &lt;/Bar&gt;
        &lt;/small&gt;
    &lt;/Vandle&gt;
</pre></div><p>You will find a detailed description of these variables in the <a class="el" href="timecal.html">Time Calibrations and VANDLE Setup</a> section.</p>
<h3><a class="anchor" id="qs-timing">
Timing Node Setup</a></h3>
<p>The Timing node contains all of the information necessary for the successful extraction of the high resolution timing from a trace. It defines things such as the trace length and delay, the ranges for the waveform, and the fitting parameters for various detectors. The most important things to update in this section are the TraceDelay and TraceLength. Please note the units that are in each of the parameters.</p>
<h3><a class="anchor" id="qs-treecorr">
TreeCorrelator Node Setup</a></h3>
<p>We will not be using the <a class="el" href="d2/da4/classTreeCorrelator.html" title="Singleton class holding map of all places.">TreeCorrelator</a> for this example, refer to <a class="el" href="treecorr.html">Tree Correlator</a> for more info on this.</p>
<h3><a class="anchor" id="qs-notebook">
NoteBook Node Setup</a></h3>
<p>Finally, you can change the output information from the notebook if you'd like. This is not a critical step.</p>
<h2><a class="anchor" id="qs-eventcreat">
Event Creation</a></h2>
<p>Events are created by grouping together channels which triggered at similar times. This time window is controlled by the variable EventWidth located in the Global node of Config.xml. If two successive channels in the list are within "EventWidth" time, they are grouped together in an event. The variable is in units of Pixie16 clock ticks and must be multiplied by the appropriate sampling time to obtain the event width in ns. Please note that the "EventWidth" time window is only applied to successive events. Thus it is possible (depending on the total trigger rate) to have events that are longer than the specified time window.</p>
<h2><a class="anchor" id="qs-eventret">
Retrieving Information from the Event</a></h2>
<p>After an event has been created it is sent for processing. The first step of processing is to calibrate the individual channels and summarize the information contained in the event. For each detector type that is present in the event an object called <a class="el" href="d4/d5c/classDetectorSummary.html" title="Summary of all channels of one detector type.">DetectorSummary</a> is created. This object holds detector related information such as the energy, timestamp, and the multiplicity of the detector among other things. For example, the following command will retrieve energy of the scint in the event. </p>
<div class="fragment"><pre class="fragment">  <span class="keywordtype">double</span> energy = revt.GetSummary(<span class="stringliteral">&quot;beta_scint:beta&quot;</span>)-&gt;GetList().begin()-&gt;GetEnergy();
</pre></div><p> where revt is the name of the variable holding the raw event information and energy will contain the energy of the scintillator.</p>
<p>To retrieve the multiplicity associated with VANDLE ends use the following command: </p>
<div class="fragment"><pre class="fragment">  <span class="keywordtype">int</span> fmult = revt.GetSummary(<span class="stringliteral">&quot;vandle&quot;</span>)-&gt;GetMult();
</pre></div><p>The reference manual can provide a list of all commands to retrieve information from the detector_summary or the rawevent.</p>
<h2><a class="anchor" id="qs-plotting">
Plotting</a></h2>
<p>All plotting is controlled through the "plot" function defined in DeclareHistogram. This function is a C++ wrapper that has been placed around the DAMM count1cc and set2cc subroutines. This allows for the code to be easily changed between damm and ROOT histograms. For those using DAMM to view the output of the analysis all plots are created in the "drrsub.f" file located in the scan directory.</p>
<p>In order to plot into a histogram one must first define it in the DeclarePlots method of the used Processor. In addition, each Processor has a specific range of DAMM IDs that it is allowed to use. This is defined in the <a class="el" href="df/dd7/DammPlotIds_8hpp.html" title="Lists Offsets and Ranges for various Processors.">DammPlotIds.hpp</a>.</p>
<p>To define a 1D and a 2D histogram, you must first define the variables for the histogram numbers: </p>
<div class="fragment"><pre class="fragment">    <span class="keyword">namespace </span>dammIds {
        <span class="keyword">namespace </span>vandle {
            <a class="code" href="d5/d2c/namespacedammIds_1_1beta__scint.html#a21d07998ae937357eef6a17e0ed284c7" title="Energy.">D_ENERGY_BETA</a> = 0;
            DD_ENERGY_TIME = 1;
            DD_BETA_TRACE = 2;
        }
    }
</pre></div><p>This is generally found near the top of the '.cpp' file of interest. For the <a class="el" href="dd/db1/classBetaScintProcessor.html" title="Detector processor that handles scintillator detectors for beta detection.">BetaScintProcessor</a>, this will create histograms with IDs 2050, 2051, and 2052. We can now define the histograms themselves in the DeclarePlots method.</p>
<div class="fragment"><pre class="fragment">    DeclareHistogram1D(<a class="code" href="d5/d2c/namespacedammIds_1_1beta__scint.html#a21d07998ae937357eef6a17e0ed284c7" title="Energy.">D_ENERGY_BETA</a>, <a class="code" href="df/dd7/DammPlotIds_8hpp.html#ae32bacd5d1cf53f3095e01cd00ab43f3">SA</a>, <a class="code" href="df/dd7/DammPlotIds_8hpp.html#ae32bacd5d1cf53f3095e01cd00ab43f3">SA</a>, <span class="stringliteral">&quot;Beta Energy&quot;</span>);
    DeclareHistogram2D(<a class="code" href="d5/d2c/namespacedammIds_1_1beta__scint.html#a21d07998ae937357eef6a17e0ed284c7" title="Energy.">D_ENERGY_BETA</a>, <a class="code" href="df/dd7/DammPlotIds_8hpp.html#ae32bacd5d1cf53f3095e01cd00ab43f3">SA</a>, <a class="code" href="df/dd7/DammPlotIds_8hpp.html#ae32bacd5d1cf53f3095e01cd00ab43f3">SA</a>, <span class="stringliteral">&quot;Beta Energy vs Time&quot;</span>);
    DeclareHistogram2D(<a class="code" href="d5/d2c/namespacedammIds_1_1beta__scint.html#a21d07998ae937357eef6a17e0ed284c7" title="Energy.">D_ENERGY_BETA</a>, <a class="code" href="df/dd7/DammPlotIds_8hpp.html#ae32bacd5d1cf53f3095e01cd00ab43f3">SA</a>, <a class="code" href="df/dd7/DammPlotIds_8hpp.html#ae32bacd5d1cf53f3095e01cd00ab43f3">SA</a>, <span class="stringliteral">&quot;Beta Traces&quot;</span>);
</pre></div><p>SA is a constant defined for compatibility with DAMM, see <a class="el" href="df/dd7/DammPlotIds_8hpp.html" title="Lists Offsets and Ranges for various Processors.">DammPlotIds.hpp</a> for their definitions.</p>
<p>To plot a one dimensional histogram of energies: </p>
<div class="fragment"><pre class="fragment">    plot(<a class="code" href="d5/d2c/namespacedammIds_1_1beta__scint.html#a21d07998ae937357eef6a17e0ed284c7" title="Energy.">D_ENERGY_BETA</a>,energy);
</pre></div><p> You can send any type of numerical value to the plot function. The variable is rounded into an integer before being passed to the DAMM plotting functions. A two dimensional histogram is plotted with the command </p>
<div class="fragment"><pre class="fragment">    plot(DD_ENERGY_TIME,energy, time);
</pre></div><p> and a three dimensional histogram (plotting a trace for example) uses the command </p>
<div class="fragment"><pre class="fragment">    plot(DD_BETATRACE, xval, row, traceval);
</pre></div><p>There are numerous examples in the code on how to do this.</p>
<h2><a class="anchor" id="qs-programexec">
Program Execution</a></h2>
<p>After the compilation has completed successfully the executable pixie_ldf_c will be present. Run the pixie_ldf_c program as you would any other program: </p>
<div class="fragment"><pre class="fragment">
  ./pixie_ldf_c hisname
  </pre></div><p> Where "hisname" is the name of the damm histogram that will be created. At the scanor prompt load in the appropriate ldf file as follows </p>
<div class="fragment"><pre class="fragment">
  SCANOR-&gt;file tutorial/tutorial.ldf
  </pre></div><p> Next start the analysis with the following command </p>
<div class="fragment"><pre class="fragment">
  SCANOR-&gt;go
  </pre></div><p>After starting a variety of output should be printed to the screen. The first lists all the detectors that are being used in the analysis. This includes information about what is happening at various stages of the code, the status of reading in the configuration, and the creation of the detector summaries.</p>
<p>After completion of the analysis, end the SCANOR program </p>
<div class="fragment"><pre class="fragment">
  SCANOR-&gt;end
  </pre></div><p> You are now ready to take a look at your output in DAMM. This concludes the main part of the tutorial.</p>
<h3><a class="anchor" id="qs-end">
Summary</a></h3>
<p>This should complete the basics on how to setup and run the code. There are a variety of histograms predefined in the Processors. Remember, under the new framework, you do not have to recompile when you are switching out Processors. Changes to the source code (new histograms, gates, etc.) necessitate compilation. </p>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 4 Jun 2016 for Pixie16 Analysis Software Suite by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
