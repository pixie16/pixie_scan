<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Pixie16 Analysis Software Suite: adding and using an optional detector processor</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Pixie16 Analysis Software Suite
   </div>
   <div id="projectbrief">Analysis code for processing of .ldf files</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('addopt.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">adding and using an optional detector processor </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="addopt-intro"></a>
Introduction</h1>
<p>We discuss here the steps one needs to follow in order to add and use an experiment specific detector processor. These types of Processors work in conjunction with their parent processors to provide additional functionality beyond the original processor's intent.</p>
<p>For example, the use of the <a class="el" href="d3/dd9/classVandleAtLeribssProcessor.html" title="Class to process VANDLE related events. ">VandleAtLeribssProcessor</a> is designed to add additional histograms, gates, and other features that need not be used in the original <a class="el" href="de/d92/classVandleProcessor.html" title="Class to process VANDLE related events. ">VandleProcessor</a>. These processors may also be used to provide completely new functionality, while still being part of an existing processor.</p>
<p>Not every processor is ready to be used in this way and may require some modifications in order to obtain this functionality. For examples of how to update your processors to use this feature take a look at the <a class="el" href="d1/d90/classGeProcessor.html" title="Processor to handle Ge (read as clover) events. ">GeProcessor</a> and the <a class="el" href="de/d92/classVandleProcessor.html" title="Class to process VANDLE related events. ">VandleProcessor</a>.</p>
<h1><a class="anchor" id="addopt-get"></a>
Getting the Optional Processors</h1>
<p>The optional processors are kept in an additional git repository, since they will not all necessarily be useful to everybody who uses this software. They can be downloaded using the following command : </p><div class="fragment"><div class="line">git clone https:<span class="comment">//github.com/pixie16/ExperimentProcessors.git</span></div></div><!-- fragment --><h1><a class="anchor" id="addopt-setup"></a>
Setting up the Environment</h1>
<p>To take advantage and ease the use of these new processors, you should export an additional environmental variable in your .bashrc. </p><div class="fragment"><div class="line">export EXTRA_PROCESSORS=/absolute/path/to/extra/processors</div></div><!-- fragment --><p> By exporting this variable, the Makefile will automatically search the directory for the desired files.</p>
<h1><a class="anchor" id="addopt-make"></a>
Setup the Makefile</h1>
<p>Unfortunately, we still need to add the processor to the Makefile so that it will be compiled and linked with the program. You should add your processor to the list of existing processors. </p><div class="fragment"><div class="line">VANDLEATLERIBSSPROCESSORO = <a class="code" href="d3/dd9/classVandleAtLeribssProcessor.html">VandleAtLeribssProcessor</a>.$(ObjSuf)</div></div><!-- fragment --><p> Second, you need to add the new processor to the list of CXX_OBJS </p><div class="fragment"><div class="line">$(VANDLEATLERIBSSPROCESSORO)</div></div><!-- fragment --><p> You can either add it in its own line or with the other processors, it really doesn't matter.</p>
<h1><a class="anchor" id="addopt-driv"></a>
Setup DetectorDriver</h1>
<p>We now need to update the processor list in <a class="el" href="d4/d4a/classDetectorDriver.html" title="DetectorDriver controls event processing. ">DetectorDriver</a>. Since we are inheriting from the <a class="el" href="de/d92/classVandleProcessor.html" title="Class to process VANDLE related events. ">VandleProcessor</a>, we will change the entry for the <a class="el" href="de/d92/classVandleProcessor.html" title="Class to process VANDLE related events. ">VandleProcessor</a> directly. The code that originally looked like this </p><div class="fragment"><div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span> (name == <span class="stringliteral">&quot;VandleProcessor&quot;</span>) {</div><div class="line">    <span class="keywordtype">double</span> res = processor.attribute(<span class="stringliteral">&quot;res&quot;</span>).as_double(2.0);</div><div class="line">    <span class="keywordtype">double</span> offset = processor.attribute(<span class="stringliteral">&quot;offset&quot;</span>).as_double(200.0);</div><div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> numStarts = processor.attribute(<span class="stringliteral">&quot;NumStarts&quot;</span>).as_int(2);</div><div class="line">    vector&lt;string&gt; types =</div><div class="line">        <a class="code" href="df/dcb/namespacestrings.html#a9bdb2686dd6d86c7879f87868e3e6026">strings::tokenize</a>(processor.attribute(<span class="stringliteral">&quot;types&quot;</span>).as_string(),<span class="stringliteral">&quot;,&quot;</span>);</div><div class="line">    vecProcess.push_back(<span class="keyword">new</span> <a class="code" href="de/d92/classVandleProcessor.html">VandleProcessor</a>(types, res, offset, numStarts));</div><div class="line">}</div></div><!-- fragment --><p> Will now look like </p><div class="fragment"><div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span> (name == <span class="stringliteral">&quot;VandleProcessor&quot;</span> || name == <span class="stringliteral">&quot;VandleAtLeribssProcessor&quot;</span>) {</div><div class="line">    <span class="keywordtype">double</span> res = processor.attribute(<span class="stringliteral">&quot;res&quot;</span>).as_double(2.0);</div><div class="line">    <span class="keywordtype">double</span> offset = processor.attribute(<span class="stringliteral">&quot;offset&quot;</span>).as_double(200.0);</div><div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> numStarts = processor.attribute(<span class="stringliteral">&quot;NumStarts&quot;</span>).as_int(2);</div><div class="line">    vector&lt;string&gt; types =</div><div class="line">        <a class="code" href="df/dcb/namespacestrings.html#a9bdb2686dd6d86c7879f87868e3e6026">strings::tokenize</a>(processor.attribute(<span class="stringliteral">&quot;types&quot;</span>).as_string(),<span class="stringliteral">&quot;,&quot;</span>);</div><div class="line">    <span class="keywordflow">if</span>(name == <span class="stringliteral">&quot;VandleProcessor&quot;</span>)</div><div class="line">        vecProcess.push_back(<span class="keyword">new</span> <a class="code" href="de/d92/classVandleProcessor.html">VandleProcessor</a>(types, res, offset, numStarts));</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (name == <span class="stringliteral">&quot;VandleAtLeribssProcessor&quot;</span>)</div><div class="line">        vecProcess.push_back(<span class="keyword">new</span> <a class="code" href="d3/dd9/classVandleAtLeribssProcessor.html">VandleAtLeribssProcessor</a>(types, res, offset, numStarts));</div><div class="line">}</div></div><!-- fragment --><p> In addition, we need to add the header file to the list at the top of <a class="el" href="d4/d4a/classDetectorDriver.html" title="DetectorDriver controls event processing. ">DetectorDriver</a>. </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="d9/d38/VandleAtLeribssProcessor_8hpp.html">VandleAtLeribssProcessor.hpp</a>&quot;</span></div></div><!-- fragment --> <h1><a class="anchor" id="addopt-cfg"></a>
Setup the Configuration File</h1>
<p>Finally, we need to update the Config.xml to use the new processor instead of the stock one. </p><div class="fragment"><div class="line">&lt;Processor name=<span class="stringliteral">&quot;VandleAtLeribssProcessor&quot;</span></div><div class="line">    types=<span class="stringliteral">&quot;small&quot;</span> res=<span class="stringliteral">&quot;2&quot;</span> offset=<span class="stringliteral">&quot;200&quot;</span> numStarts=<span class="stringliteral">&quot;2&quot;</span>/&gt;</div></div><!-- fragment --><p> This code will replace the line for the <a class="el" href="de/d92/classVandleProcessor.html" title="Class to process VANDLE related events. ">VandleProcessor</a> in the <a class="el" href="d4/d4a/classDetectorDriver.html" title="DetectorDriver controls event processing. ">DetectorDriver</a> node.</p>
<h1><a class="anchor" id="addopt-tips"></a>
Tips and Tricks</h1>
<p>One thing to keep in mind is that the constructor for the child processor must accept at a minimum the same number of arguments that the parent does. This does not mean that you are limited in any way for a maximum.</p>
<p>In this example we could have added an additional argument to the constructor for the <a class="el" href="d3/dd9/classVandleAtLeribssProcessor.html" title="Class to process VANDLE related events. ">VandleAtLeribssProcessor</a> for the number of the banana that we would like to analyze. This argument would not need to be passed to the constructor for the parent. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">Pixie16 Analysis Software</a></li><li class="navelem"><a class="el" href="devman.html">Developer Manual (under construction)</a></li>
    <li class="footer">Generated on Sun Jun 5 2016 08:08:20 for Pixie16 Analysis Software Suite by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
